# ================================================================
# Cursor Rules — Auto Drafter Project (auto_drafter_system.py)
# ================================================================
# 此檔案定義 AI 助手在此專案中的行為準則。
# Cursor IDE 在每次對話開始時會自動載入這些規則。

# ================================================================
# 1. 修改後必須驗證（最重要的規則）
# ================================================================
# 每次修改 auto_drafter_system.py 後，必須執行自動化測試：
#
#   py test/verify_values.py
#
# - 此腳本會驗證所有關鍵數值（R, angle, h_gain, arc_len 等）
# - 會生成 4 張 DXF 圖面並檢查內容
# - 所有測試必須通過後才可報告「修改完成」
# - 若測試失敗，必須修復後重新測試，直到全部通過
#
# 快速驗證（只檢查數值不生成圖面）：
#   py test/verify_values.py --quick
#
# 禁止：
# - 只做理論推導就報告修改完成
# - 跳過測試直接提交
# - 測試失敗後不修復就結束

# ================================================================
# 2. 找不到檔案時必須立即反應
# ================================================================
# 當使用者引用檔案路徑（圖片、模型、文件）但找不到時：
# - 必須立即告知使用者「找不到該檔案」
# - 詢問是否路徑有誤，或請使用者重新提供
# - 禁止默默跳過或假裝理解

# ================================================================
# 3. 圖面數值基準（2-2.stp 標準答案）
# ================================================================
# 以下數值為 test/2-2.stp 模型的正確繪圖數值，
# 定義在 test/verify_values.py 的 EXPECTED dict 中：
#
# 弧段參數（Draw 2 核心）：
#   R = 250, angle = 180°, h_gain = 490.8, arc_len = 926
#   3D 端點距離 ≈ 700, 弦長 = 500
#
# 軌道間距（彎軌區段 F03-F06）：
#   curved_rail_spacing = 230.2
#
# 腳架長度（total_len - 50, 個位數4捨5入10位）：
#   leg_1 = 510, leg_2 = 480, leg_3 = 440
#
# 其他：
#   pipe_diameter = 48.1
#   bracket_count = 5
#   bend_direction = left
#   elevation = 32°
#   upper_bend_r = 270, lower_bend_r = 220

# ================================================================
# 4. 測試模型路徑
# ================================================================
# 主要測試模型：test/2-2.stp
# 測試腳本：test/verify_values.py
# 輸出目錄：output/

# ================================================================
# 5. 開發工作流程
# ================================================================
# 標準流程：
#   1. 理解需求（如果有參考圖片，確認能看到）
#   2. 修改程式碼
#   3. 執行 py test/verify_values.py
#   4. 若失敗 → 修復 → 回到步驟 3
#   5. 全部通過 → 報告結果
#
# 調試流程：
#   1. 先執行 py test/verify_values.py --quick 確認當前狀態
#   2. 定位問題
#   3. 修復
#   4. 執行完整 py test/verify_values.py 確認

# ================================================================
# 6. 程式碼風格
# ================================================================
# - 使用中文註釋（配合專案慣例）
# - 新增函數需有 docstring
# - 關鍵數值變更需在 log_print 中記錄
# - 弧段擷取使用 3D 圓擬合 + 最佳投影面選擇 + U 參數弧長
